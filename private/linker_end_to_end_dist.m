function [ prob_density ] = linker_end_to_end_dist( r, p )
%UNTITLED3 Summary of this function goes here
%   Detailed explanation goes here

%{
if strcmp(linker, 'BMOE')
    d = [5,0;5.10000000000000,0;5.20000000000000,0;5.30000000000000,0;5.40000000000000,0;5.50000000000000,0;5.60000000000000,0;5.70000000000000,0;5.80000000000000,0;5.90000000000000,0;6,0;6.10000000000000,0;6.20000000000000,0.00615960331123772;6.30000000000000,0.0162623836376194;6.40000000000000,0.0213137738008102;6.50000000000000,0.0263651639640011;6.60000000000000,0.0624465222725070;6.70000000000000,0.0624465222725070;6.80000000000000,0.0978062534148428;6.90000000000000,0.128836221560158;7,0.159144562539303;7.10000000000000,0.210380091337381;7.20000000000000,0.226255888993124;7.30000000000000,0.318624166262899;7.40000000000000,0.318624166262899;7.50000000000000,0.476660515654155;7.60000000000000,0.487484923146707;7.70000000000000,0.605110151232436;7.80000000000000,0.605110151232436;7.90000000000000,0.666448460356897;8,0.666448460356897;8.10000000000000,0.584182963413503;8.20000000000000,0.563977402760740;8.30000000000000,0.563977402760740;8.40000000000000,0.379962475387359;8.50000000000000,0.364808304897787;8.60000000000000,0.348932507242044;8.70000000000000,0.231307279156315;8.80000000000000,0.205328701174191;8.90000000000000,0.154093172376112;9,0.154093172376112;9.10000000000000,0.154093172376112;9.20000000000000,0.154093172376112;9.30000000000000,0.139660629052710;9.40000000000000,0.139660629052710;9.50000000000000,0.133165984557179;9.60000000000000,0.128836221560158;9.70000000000000,0.108630660907395;9.80000000000000,0.0826520829252703;9.90000000000000,0.0783223199282497;10,0.0674979124356978;10.1000000000000,0.0314165541271919;10.2000000000000,0.0263651639640011;10.3000000000000,0.0263651639640011;10.4000000000000,0.0104893663082584;10.5000000000000,0.00615960331123772;10.6000000000000,0;10.7000000000000,0;10.8000000000000,0;10.9000000000000,0;11,0]; 
end
if strcmp(linker, 'BMH')
    d = [0,0;0.100000000000000,0;0.200000000000000,0;0.300000000000000,0;0.400000000000000,0;0.500000000000000,0;0.600000000000000,0;0.700000000000000,0;0.800000000000000,0;0.900000000000000,0;1,0;1.10000000000000,0;1.20000000000000,0;1.30000000000000,0;1.40000000000000,0;1.50000000000000,0;1.60000000000000,0;1.70000000000000,0;1.80000000000000,0;1.90000000000000,0;2,0;2.10000000000000,0;2.20000000000000,0;2.30000000000000,0;2.40000000000000,0;2.50000000000000,0;2.60000000000000,0;2.70000000000000,0;2.80000000000000,0;2.90000000000000,0;3,0;3.10000000000000,0;3.20000000000000,0;3.30000000000000,0;3.40000000000000,0;3.50000000000000,0;3.60000000000000,0;3.70000000000000,0;3.80000000000000,0;3.90000000000000,0;4,0;4.10000000000000,0;4.20000000000000,0;4.30000000000000,0.00186643172148717;4.40000000000000,0.00420154438875647;4.50000000000000,0.00420154438875647;4.60000000000000,0.00863942842165345;4.70000000000000,0.0107479807912319;4.80000000000000,0.0130800653135746;4.90000000000000,0.0154147650519903;5,0.0177573104386249;5.10000000000000,0.0243014069109298;5.20000000000000,0.0287421814458022;5.30000000000000,0.0287498894510699;5.40000000000000,0.0287421814458022;5.50000000000000,0.0287421814458022;5.60000000000000,0.0287421814458022;5.70000000000000,0.0352836627020341;5.80000000000000,0.0352836627020341;5.90000000000000,0.0467416125325184;6,0.0511927102887315;6.10000000000000,0.0577418995502311;6.20000000000000,0.0577418995502311;6.30000000000000,0.0577314386859391;6.40000000000000,0.0598399910555176;6.50000000000000,0.0598399910555176;6.60000000000000,0.0621720755778603;6.70000000000000,0.0734014004663857;6.80000000000000,0.0843964570519524;6.90000000000000,0.0843964570519524;7,0.0914057866993454;7.10000000000000,0.0914057866993454;7.20000000000000,0.0867208335690274;7.30000000000000,0.0867208335690274;7.40000000000000,0.0914057866993454;7.50000000000000,0.113627415314413;7.60000000000000,0.113627415314413;7.70000000000000,0.113627415314413;7.80000000000000,0.104725495087890;7.90000000000000,0.0913825250405910;8,0.0913825250405910;8.10000000000000,0.100269166899530;8.20000000000000,0.0979266215128959;8.30000000000000,0.100269166899530;8.40000000000000,0.100269166899530;8.50000000000000,0.0979266215128959;8.60000000000000,0.0979266215128959;8.70000000000000,0.100256090819166;8.80000000000000,0.100256090819166;8.90000000000000,0.106805417723616;9,0.118031989753118;9.10000000000000,0.124812556815600;9.20000000000000,0.124812556815600;9.30000000000000,0.124812556815600;9.40000000000000,0.131366976509246;9.50000000000000,0.124812556815600;9.60000000000000,0.140482518596047;9.70000000000000,0.142590933322674;9.80000000000000,0.140482518596047;9.90000000000000,0.144923155487968;10,0.153812274920029;10.1000000000000,0.165038846949530;10.2000000000000,0.165038846949530;10.3000000000000,0.165038846949530;10.4000000000000,0.165028386085238;10.5000000000000,0.165028386085238;10.6000000000000,0.165028386085238;10.7000000000000,0.182801532160166;10.8000000000000,0.191695744381422;10.9000000000000,0.191695744381422;11,0.191695744381422;11.1000000000000,0.207368321377942;11.2000000000000,0.209466412883228;11.3000000000000,0.211808958269863;11.4000000000000,0.211808958269863;11.5000000000000,0.220687754480583;11.6000000000000,0.225138852236797;11.7000000000000,0.220687754480583;11.8000000000000,0.211798772691473;11.9000000000000,0.164989708415949;12,0.164989708415949;12.1000000000000,0.160312463290898;12.2000000000000,0.153755290738229;12.3000000000000,0.146964400454405;12.4000000000000,0.142516055557216;12.5000000000000,0.142513577984094;12.6000000000000,0.117941558334173;12.7000000000000,0.0865840164755251;12.8000000000000,0.0865787860433792;12.9000000000000,0.0755835918148612;13,0.0643417414177758;13.1000000000000,0.0620069040364089;13.2000000000000,0.0575585591392200;13.3000000000000,0.0575533287070741;13.4000000000000,0.0397622890484891;13.5000000000000,0.0350847686375363;13.6000000000000,0.0350847686375363;13.7000000000000,0.0350847686375363;13.8000000000000,0.0329686459056413;13.9000000000000,0.0285201633655012;14,0.0285201633655012;14.1000000000000,0.0261750027627936;14.2000000000000,0.0175146459156426;14.3000000000000,0.0175146459156426;14.4000000000000,0.0175146459156426;14.5000000000000,0.0151721005290079;14.6000000000000,0.0151617773076672;14.7000000000000,0.0128245999961298;14.8000000000000,0.0128168919908621;14.9000000000000,0.0128168919908621;15,0.00392763491584956;15.1000000000000,0.00391992691058184;15.2000000000000,0;15.3000000000000,0;15.4000000000000,0;15.5000000000000,0;15.6000000000000,0;15.7000000000000,0;15.8000000000000,0;15.9000000000000,0;16,0;16.1000000000000,0;16.2000000000000,0;16.3000000000000,0;16.4000000000000,0;16.5000000000000,0;16.6000000000000,0;16.7000000000000,0;16.8000000000000,0;16.9000000000000,0;17,0;17.1000000000000,0;17.2000000000000,0;17.3000000000000,0;17.4000000000000,0;17.5000000000000,0;17.6000000000000,0;17.7000000000000,0;17.8000000000000,0;17.9000000000000,0;18,0];
end      
if strcmp(linker, 'BM')
    d = [9,0;9.10000000000000,0;9.20000000000000,0;9.30000000000000,0;9.40000000000000,0;9.50000000000000,0.00448308740522689;9.60000000000000,0.00448308740522689;9.70000000000000,0.00448308740522689;9.80000000000000,0.00448308740522689;9.90000000000000,0.00448308740522689;10,0.00927590059487295;10.1000000000000,0.00927590059487295;10.2000000000000,0.00927590059487295;10.3000000000000,0.00927590059487295;10.4000000000000,0.00927590059487295;10.5000000000000,0.0140687137845190;10.6000000000000,0.0140687137845190;10.7000000000000,0.0140687137845190;10.8000000000000,0.0239538909881641;10.9000000000000,0.0239538909881641;11,0.0290462550021630;11.1000000000000,0.0437242453954541;11.2000000000000,0.0488166094094530;11.3000000000000,0.0488166094094530;11.4000000000000,0.0488166094094530;11.5000000000000,0.0488166094094530;11.6000000000000,0.0536094225990991;11.7000000000000,0.0536094225990991;11.8000000000000,0.0781725901960352;11.9000000000000,0.0781725901960352;12,0.0829654033856813;12.1000000000000,0.0829654033856813;12.2000000000000,0.0829654033856813;12.3000000000000,0.0829654033856813;12.4000000000000,0.107528570982617;12.5000000000000,0.122506112200261;12.6000000000000,0.122506112200261;12.7000000000000,0.122506112200261;12.8000000000000,0.122506112200261;12.9000000000000,0.122506112200261;13,0.127298925389907;13.1000000000000,0.127298925389907;13.2000000000000,0.161747270190489;13.3000000000000,0.161747270190489;13.4000000000000,0.166540083380135;13.5000000000000,0.161747270190489;13.6000000000000,0.166540083380135;13.7000000000000,0.186310437787425;13.8000000000000,0.186310437787425;13.9000000000000,0.166540083380135;14,0.166540083380135;14.1000000000000,0.166540083380135;14.2000000000000,0.166540083380135;14.3000000000000,0.206080792194715;14.4000000000000,0.235436772981297;14.5000000000000,0.235436772981297;14.6000000000000,0.235436772981297;14.7000000000000,0.250114763374588;14.8000000000000,0.250114763374588;14.9000000000000,0.260299491402586;15,0.309425826596458;15.1000000000000,0.309425826596458;15.2000000000000,0.279770294985523;15.3000000000000,0.279770294985523;15.4000000000000,0.235436772981297;15.5000000000000,0.235436772981297;15.6000000000000,0.240529136995296;15.7000000000000,0.240529136995296;15.8000000000000,0.240529136995296;15.9000000000000,0.240529136995296;16,0.230643959791651;16.1000000000000,0.230643959791651;16.2000000000000,0.200988428180716;16.3000000000000,0.196195614991070;16.4000000000000,0.196195614991070;16.5000000000000,0.161747270190489;16.6000000000000,0.151862092986844;16.7000000000000,0.137184102593553;16.8000000000000,0.122506112200261;16.9000000000000,0.117413748186262;17,0.0488166094094530;17.1000000000000,0.0437242453954541;17.2000000000000,0.0191610777985180;17.3000000000000,0.00448308740522689;17.4000000000000,0;17.5000000000000,0;17.6000000000000,0;17.7000000000000,0;17.8000000000000,0;17.9000000000000,0;18,0];
end  
if strcmp(linker, 'pPDM')
    d = [8,0;8.10000000000000,0;8.20000000000000,0;8.30000000000000,0;8.40000000000000,0;8.50000000000000,0;8.60000000000000,0;8.70000000000000,0;8.80000000000000,0;8.90000000000000,0;9,0;9.10000000000000,0;9.20000000000000,0.00917338720528957;9.30000000000000,0.00917338720528957;9.40000000000000,0.0201639132195837;9.50000000000000,0.0201639132195837;9.60000000000000,0.0404541150921268;9.70000000000000,0.0455266655602625;9.80000000000000,0.0708894179009413;9.90000000000000,0.0708894179009413;10,0.101324720709756;10.1000000000000,0.168113301873543;10.2000000000000,0.172340427263656;10.3000000000000,0.234056457959308;10.4000000000000,0.300845039123096;10.5000000000000,0.316062690527503;10.6000000000000,0.366788195208860;10.7000000000000,0.504592482926549;10.8000000000000,0.546018311749657;10.9000000000000,0.647469321112372;11,0.677904623921187;11.1000000000000,0.790346159298196;11.2000000000000,0.790346159298196;11.3000000000000,0.790346159298196;11.4000000000000,0.749765755553110;11.5000000000000,0.647469321112372;11.6000000000000,0.566308513622200;11.7000000000000,0.499519932458413;11.8000000000000,0.351570543804453;11.9000000000000,0.270409736314281;12,0.116542372114163;12.1000000000000,0.0649714423547829;12.2000000000000,0.0404541150921268;12.3000000000000,0;12.4000000000000,0;12.5000000000000,0;12.6000000000000,0;12.7000000000000,0;12.8000000000000,0;12.9000000000000,0;13,0;13.1000000000000,0;13.2000000000000,0;13.3000000000000,0;13.4000000000000,0;13.5000000000000,0;13.6000000000000,0;13.7000000000000,0;13.8000000000000,0;13.9000000000000,0;14,0];
end
if strcmp(linker, 'mPDM')
    d = [8,0;8.10000000000000,0;8.20000000000000,0;8.30000000000000,0;8.40000000000000,0;8.50000000000000,0;8.60000000000000,0;8.70000000000000,0;8.80000000000000,0.00957031322369674;8.90000000000000,0.00960390597155882;9,0.0358442476581882;9.10000000000000,0.0402988663050255;9.20000000000000,0.0560703860759207;9.30000000000000,0.0613372883800808;9.40000000000000,0.0666063934873793;9.50000000000000,0.0920652907606250;9.60000000000000,0.148936160788920;9.70000000000000,0.214779598701121;9.80000000000000,0.292589213962454;9.90000000000000,0.297109916703446;10,0.303124670673128;10.1000000000000,0.466938328871024;10.2000000000000,0.513337623479661;10.3000000000000,0.590399937776257;10.4000000000000,0.621094347408939;10.5000000000000,0.626427884508039;10.6000000000000,0.662358907901726;10.7000000000000,0.667626360906671;10.8000000000000,0.662358907901726;10.9000000000000,0.626560603397133;11,0.626560603397133;11.1000000000000,0.600353303757581;11.2000000000000,0.534608441285828;11.3000000000000,0.364911646605776;11.4000000000000,0.359644193600832;11.5000000000000,0.237062604549430;11.6000000000000,0.118186681077775;11.7000000000000,0.0621313989115112;11.8000000000000,0.0315019719714149;11.9000000000000,0;12,0;12.1000000000000,0;12.2000000000000,0;12.3000000000000,0;12.4000000000000,0;12.5000000000000,0;12.6000000000000,0;12.7000000000000,0;12.8000000000000,0;12.9000000000000,0;13,0;13.1000000000000,0;13.2000000000000,0;13.3000000000000,0;13.4000000000000,0;13.5000000000000,0;13.6000000000000,0;13.7000000000000,0;13.8000000000000,0;13.9000000000000,0;14,0];
end

   lim = [min(d(:,1)), max(d(:,1))];
    p = zeros(size(r,1), size(r,2));
    p(r>lim(1) & r<lim(2)) = interp1(d(:,1), d(:,2), r(r>lim(1) & r<lim(2)));

%}

    prob_density = exp(polyval(p(1:end-1), r))/p(end); 

 

end

